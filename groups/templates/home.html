{% extends 'base.html' %}

{% block body %}
    <h1> Grupos de Email do ITA </h1>
    <br> 
    <div>
        <form>
            <input type="text" name="search_group" id="id_search_group" />
            <button type="submit" id="id_search_button"> Pesquisar </button> 
        </form>
    </div>  
    <br>
    <br>

    <table id="id_search_list">
        {% if groups %}
        <tr>
            <td> # </td>
            <td> Name </td>
            <td> Alias</td>
            <td> Description </td>
        </tr>
        {% endif %}
        {% for group in groups %}
        <tr>
            <td> {{ forloop.counter }} </td>
            <td> {{ group.name }} </td>
            <td> {{ group.alias }}</td>
            <td> {{ group.description }}</td>
        </tr>
        {% endfor %}
    </table>

    <span class="createGroup">
        <button type="button" id="id_create_group">Criar Grupo</button>
    </span> 

    
     {% if open_popup %}
        <script>
            $(document).ready(function()
            {
                //alert("Success");
                var hiddenSection = $('section.hidden');
                hiddenSection.fadeIn()
                // unhide section.hidden
                .css({ 'display':'block' })
                // set to full screen
                .css({ width: $(window).width() + 'px', height: $(window).height() + 'px' })
                .css({ top:($(window).height() - hiddenSection.height())/2 + 'px',
                    left:($(window).width() - hiddenSection.width())/2 + 'px' })
                // greyed out background
                .css({ 'background-color': 'rgba(0,0,0,0.5)' })
                .appendTo('body');
                // console.log($(window).width() + ' - ' + $(window).height());
                $('span.close').click(function(){ $(hiddenSection).fadeOut(); document.location.href="/";});
            });
        </script>
    {% endif %}


    <section class="hidden" id='id_popup'>
        <article class="popup" >
            <p>
                {% if group_success %}

                    <div>
                        <pre>
                                            <span class="close">X</span>
                        <div>{{ group_name }} criado com sucesso!          </div>
                        <div>Alias: {{group_alias}}        </div>
                        <div>Tags: {{group_tags}}          </div>
                        <div>Description: {{group_description}}   </div>
                        </pre>
                    </div>
                {% else %}    
                <form method="POST">
                    <pre>
                                            <span class="close">X</span>
                        <div>Nome:          <input name="group_name" id="id_group_name" /><br>{{group_name_error_message}}</div>
                        <div>Alias:         <input name="group_alias" id="id_group_alias" placeholder="itagroups_alias@googlegroups.com" /><br>{{group_alias_error_message}}</div>
                        <div>Tags:          <input name="group_tags" id="id_group_tags" placeholder="Tags; separadas; por; ponto-e-virgula;" /><br>{{group_tags_error_message}}</div>
                        <div>Description:   <input type="text" name="group_description" id="id_group_description" /><br>{{group_description_error_message}}</div>
                        <div>                        <button type="submit" id="id_create_new_group"> Criar </button></div>
                        {% csrf_token %}
                    </pre>
                </form>
                {% endif %}
            </p>
        </article>
    </section>
{% endblock %}